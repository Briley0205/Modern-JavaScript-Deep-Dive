## 📕 오늘 공부한 내용, 이렇게 정리해 봅시다. ✒

**TIL(Today I learn) 기록일** : 2022.08.11

**오늘 읽은 범위** : 24장 클로저

### 클로저란 무엇인가 📑

- 클로저는 자바스크립트 고유의 개념이 아니지만 함수형 프로그래밍 언어들에게 매우 중요한 특성이다.
- 클로저가 자바스크립트 개념이 아니기 때문에 ECMA에서 찾을수는 없다.
- MDN 에서는 찾을 수가 있다.

> 클로저란 함수와 그 함수가 선언된 렉시컬 환경의 조합이다.

- 렉시컬환경은 렉시컬 스코프를 가지며 자바스크립트는 렉시컬 스코프를 따르는 프로그래밍 언어이다.

- 오늘 이거 중요성을 배웠는데 바로 읽을 챕터인게 신기하다.

### 렉시컬환경

- 함수는 자신의 내부 슬롯에 자신이 정의된 횐경 = 상위스코프의 참조를 기억한다.

순서

1. 함수실행 컨텍스트 생성
2. 함수 렉시컬환경 생성
   1. 함수환경 레코드 생성
   2. this 바인딩
   3. 외부렉시컬 환경에 대한 참조 결정

- 그리고 이 렉시컬 환경을 이용해 바깥함수 안에 중첩함수를 만들고 이 중첩함수를 불러옴으로써 중첩함수가 '이미 생명주기를 종료한 바깥함수의 변수를 참조' 할수 있게 한다.

- 정확히 말하면 모든 자바스크립트의 함수는 클로저로 동작할수가 있지만 우리는 클로저로서 동작하고 있는 애만 클로저라고 부르기로 했다.

- 중첩 함수가 상위 스코프의 식별자를 참조하고 있고 중첩함수가 바깥 함수보다 더 오래 유지되고 있다면 클로저다.

- 클로저에 의해 참조되는 상위 스코프의 변수를 자유변수라고 부르며 클로저의 의미는 함수가 자유변수에 대해 닫혀있다는 뜻이다.

---

### 리액트에서 클로저가 쓰이는 곳

- 클로저는 상태state를 안전하게 변경하고 유지하기 위해 사용한다. 상태가 의도치않게 변경되지 않도록 안전하게 은닉하고 특정 함수에게만 상태변경을 허용하기 위해 사용한다.

- 이 말을 들으면 당연하게 떠오르는 것이 setState이다.
- setState는 state<- 상태를 오직 setState만을 사용해서 바꾸고 state를 잘 저장해놨다가 꺼내쓸수도 있으며, 페이지를 새로고침 하지 않아도 유지된다.

- setState가 객체가 아닌 함수인데 상태를 저장하고 바꿀 수 있는 것이 바로 클로저의 신기한 점이다.

- redux store가 스토어에 객체 형태로 상태를 저장하고 디스패치를 사용하는 것 또한 클로저의 원리이다.

- 변수값은 누군가에 의해 언제든지 변경될 수 있어 오류 발생의 근본적 원인이 될 수 있다. 외부 상태 변경이나 가변 데이터를 피하고 불변성을 지향하는 함수형 프로그래밍에서 부수효과를 최대한 억제하여 오류를 피하고 프로그램의 안정성을 높이기 위해 클로저를 적극적으로 사용하는게 좋다.

- 상위스코프를 참조한다는 것 때문에 최적화에 문제가 생기지 않을까 생각하지만 똑똑한 모던 자바스크립트 엔진은 이런 걸 잘 핸들링할 수 있게 연습하고 있다.

### 후기

- 면접때 클로저를 물어봤을때...! 그냥 렉시컬 환경과 이너함수를 대답하는 것보다 setState가 클로저라고 예시를 들면서 설명하는 편이 설명하기도 쉽고 듣는 쪽에서도 귀가 편안하다고 한다.
- 그래서 클로저를 한번 정리해봐야지 라고 생각했는데 마침 클로저 챕터에 도달!
- 신기하다. 참고로 setState의 내부 코드를 뜯어보고 정리한다음 정확한 위치를 짚어가며 설명할수 있으면 더 좋다고 한다.

- 취업을 위해 화이팅!
