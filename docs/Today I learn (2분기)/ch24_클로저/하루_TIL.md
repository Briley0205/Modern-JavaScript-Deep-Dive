## 📕 오늘 공부한 내용, 이렇게 정리해 봅시다. ✒

**TIL(Today I learn) 기록일** : 2022.08.20

**오늘 읽은 범위** : 24장 클로저

### 

### [[Environment]]

> 함수 내부에서 정의된 함수 표현식은 **외부 함수 코드** 가 실행되는 시점에 **평가** 되어 함수 객체를 생성한다. 이때 [[Environment]] 에는 외부 함수코드 실행 시점에 실행 중인 실행 컨텍스트의 릭세컬 환경인 외부 함수 렉시컬 환경의 참조가 저장된다.
> 
> 
> 따라서, [[Environment]] 에 저장된 현재 실행 중인 실행 컨텍스트의 렉시컬 환경의 참조가 바로 상위 스코프다. 
> 
> 함수 객체는 [[Environment]] 에 저장한 상위 스코프를 **자신이 존재하는 한 기억한다.**
> 

### 클로저

```jsx
const x = 1;

// ①
function outer() {
  const x = 10;
  const inner = function () { console.log(x); }; // ②
  return inner;
}

// outer 함수를 호출하면 중첩 함수 inner를 반환한다.
// 그리고 outer 함수의 실행 컨텍스트는 실행 컨텍스트 스택에서 팝되어 제거된다.
const innerFunc = outer(); // ③
innerFunc(); // ④ 10
```

- 외부 함수보다 중첩 함수가 더 오래 유지되는 경우 중첩 함수는 이미 생명 주기가 종료한 외부 함수의 변수를 참조할 수 있다. 이러한 중첩 함수를 클로저 라고 부른다.
    - ③ 에서 outer 함수의 실행이 종료되며 생명 주기가 종료된다. 즉 실행 컨텍스트 스택에서 제거된다. 다만, **렉시컬 환경은 소멸되지 않는다**.
    - outer 함수의 렉시컬 환경은 inner 함수의  [[Environment]] 내부 슬롯에 의해 참조 되고 있고, inner 함수는 전역 변수 innerFunc 에 참조 되고 있음으로 가비지 컬렉션의 대상이 되지 않는다.
